// Event Image Library - Curated free images for events
// Using Unsplash images (free to use)

const EVENT_IMAGE_LIBRARY = {
    environment: [
        {
            id: 'env-1',
            url: 'https://images.unsplash.com/photo-1532996122724-e3c354a0b15b?w=600&h=400&fit=crop',
            name: 'Beach Cleanup',
            tags: ['beach', 'cleanup', 'ocean']
        },
        {
            id: 'env-2',
            url: 'https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?w=600&h=400&fit=crop',
            name: 'Tree Planting',
            tags: ['tree', 'planting', 'nature']
        },
        {
            id: 'env-3',
            url: 'https://images.unsplash.com/photo-1441974231531-c6227db76b6e?w=600&h=400&fit=crop',
            name: 'Forest Conservation',
            tags: ['forest', 'green', 'conservation']
        },
        {
            id: 'env-4',
            url: 'https://images.unsplash.com/photo-1618477388954-7852f32655ec?w=600&h=400&fit=crop',
            name: 'Park Cleanup',
            tags: ['park', 'cleanup', 'community']
        },
        {
            id: 'env-5',
            url: 'https://images.unsplash.com/photo-1567095761054-7a02e69e5c43?w=600&h=400&fit=crop',
            name: 'River Cleanup',
            tags: ['river', 'water', 'cleanup']
        },
        {
            id: 'env-6',
            url: 'https://images.unsplash.com/photo-1470071459604-3b5ec3a7fe05?w=600&h=400&fit=crop',
            name: 'Nature Trail',
            tags: ['trail', 'hiking', 'nature']
        }
    ],
    education: [
        {
            id: 'edu-1',
            url: 'https://images.unsplash.com/photo-1503676260728-1c00da094a0b?w=600&h=400&fit=crop',
            name: 'Classroom Teaching',
            tags: ['classroom', 'teaching', 'school']
        },
        {
            id: 'edu-2',
            url: 'https://images.unsplash.com/photo-1509062522246-3755977927d7?w=600&h=400&fit=crop',
            name: 'Kids Learning',
            tags: ['kids', 'learning', 'fun']
        },
        {
            id: 'edu-3',
            url: 'https://images.unsplash.com/photo-1497633762265-9d179a990aa6?w=600&h=400&fit=crop',
            name: 'Library & Books',
            tags: ['library', 'books', 'reading']
        },
        {
            id: 'edu-4',
            url: 'https://images.unsplash.com/photo-1522202176988-66273c2fd55f?w=600&h=400&fit=crop',
            name: 'Group Study',
            tags: ['group', 'study', 'collaboration']
        },
        {
            id: 'edu-5',
            url: 'https://images.unsplash.com/photo-1488190211105-8b0e65b80b4e?w=600&h=400&fit=crop',
            name: 'Tutoring Session',
            tags: ['tutoring', 'mentor', 'learning']
        },
        {
            id: 'edu-6',
            url: 'https://images.unsplash.com/photo-1571260899304-425eee4c7efc?w=600&h=400&fit=crop',
            name: 'Computer Training',
            tags: ['computer', 'technology', 'training']
        }
    ],
    health: [
        {
            id: 'health-1',
            url: 'https://images.unsplash.com/photo-1576091160399-112ba8d25d1f?w=600&h=400&fit=crop',
            name: 'Medical Care',
            tags: ['medical', 'healthcare', 'clinic']
        },
        {
            id: 'health-2',
            url: 'https://images.unsplash.com/photo-1571019614242-c5c5dee9f50b?w=600&h=400&fit=crop',
            name: 'Fitness Activity',
            tags: ['fitness', 'exercise', 'wellness']
        },
        {
            id: 'health-3',
            url: 'https://images.unsplash.com/photo-1559757148-5c350d0d3c56?w=600&h=400&fit=crop',
            name: 'Mental Wellness',
            tags: ['mental', 'wellness', 'peace']
        },
        {
            id: 'health-4',
            url: 'https://images.unsplash.com/photo-1505576399279-565b52d4ac71?w=600&h=400&fit=crop',
            name: 'Healthy Food',
            tags: ['food', 'nutrition', 'healthy']
        },
        {
            id: 'health-5',
            url: 'https://images.unsplash.com/photo-1532938911079-1b06ac7ceec7?w=600&h=400&fit=crop',
            name: 'Health Checkup',
            tags: ['checkup', 'doctor', 'care']
        },
        {
            id: 'health-6',
            url: 'https://images.unsplash.com/photo-1544367567-0f2fcb009e0b?w=600&h=400&fit=crop',
            name: 'Yoga Session',
            tags: ['yoga', 'meditation', 'wellness']
        }
    ],
    charity: [
        {
            id: 'charity-1',
            url: 'https://images.unsplash.com/photo-1593113598332-cd288d649433?w=600&h=400&fit=crop',
            name: 'Donation Drive',
            tags: ['donation', 'charity', 'giving']
        },
        {
            id: 'charity-2',
            url: 'https://images.unsplash.com/photo-1532629345422-7515f3d16bb6?w=600&h=400&fit=crop',
            name: 'Helping Hands',
            tags: ['helping', 'hands', 'together']
        },
        {
            id: 'charity-3',
            url: 'https://images.unsplash.com/photo-1469571486292-0ba58a3f068b?w=600&h=400&fit=crop',
            name: 'Food Distribution',
            tags: ['food', 'distribution', 'help']
        },
        {
            id: 'charity-4',
            url: 'https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?w=600&h=400&fit=crop',
            name: 'Children Support',
            tags: ['children', 'support', 'care']
        },
        {
            id: 'charity-5',
            url: 'https://images.unsplash.com/photo-1559027615-cd4628902d4a?w=600&h=400&fit=crop',
            name: 'Community Service',
            tags: ['community', 'service', 'volunteer']
        },
        {
            id: 'charity-6',
            url: 'https://images.unsplash.com/photo-1578357078586-491adf1aa5ba?w=600&h=400&fit=crop',
            name: 'Clothing Donation',
            tags: ['clothing', 'donation', 'winter']
        }
    ],
    community: [
        {
            id: 'comm-1',
            url: 'https://images.unsplash.com/photo-1559027615-cd4628902d4a?w=600&h=400&fit=crop',
            name: 'Community Gathering',
            tags: ['gathering', 'people', 'together']
        },
        {
            id: 'comm-2',
            url: 'https://images.unsplash.com/photo-1517457373958-b7bdd4587205?w=600&h=400&fit=crop',
            name: 'Street Festival',
            tags: ['festival', 'celebration', 'fun']
        },
        {
            id: 'comm-3',
            url: 'https://images.unsplash.com/photo-1464207687429-7505649dae38?w=600&h=400&fit=crop',
            name: 'Neighborhood Event',
            tags: ['neighborhood', 'local', 'community']
        },
        {
            id: 'comm-4',
            url: 'https://images.unsplash.com/photo-1529156069898-49953e39b3ac?w=600&h=400&fit=crop',
            name: 'Group Activity',
            tags: ['group', 'activity', 'teamwork']
        },
        {
            id: 'comm-5',
            url: 'https://images.unsplash.com/photo-1556761175-5973dc0f32e7?w=600&h=400&fit=crop',
            name: 'Team Building',
            tags: ['team', 'building', 'office']
        },
        {
            id: 'comm-6',
            url: 'https://images.unsplash.com/photo-1523580494863-6f3031224c94?w=600&h=400&fit=crop',
            name: 'Outdoor Gathering',
            tags: ['outdoor', 'gathering', 'nature']
        }
    ],
    animals: [
        {
            id: 'animal-1',
            url: 'https://images.unsplash.com/photo-1548199973-03cce0bbc87b?w=600&h=400&fit=crop',
            name: 'Dog Shelter',
            tags: ['dog', 'shelter', 'pets']
        },
        {
            id: 'animal-2',
            url: 'https://images.unsplash.com/photo-1450778869180-41d0601e046e?w=600&h=400&fit=crop',
            name: 'Pet Care',
            tags: ['pet', 'care', 'animal']
        },
        {
            id: 'animal-3',
            url: 'https://images.unsplash.com/photo-1425082661705-1834bfd09dca?w=600&h=400&fit=crop',
            name: 'Cat Rescue',
            tags: ['cat', 'rescue', 'kitten']
        },
        {
            id: 'animal-4',
            url: 'https://images.unsplash.com/photo-1474511320723-9a56873571b7?w=600&h=400&fit=crop',
            name: 'Wildlife Conservation',
            tags: ['wildlife', 'conservation', 'nature']
        },
        {
            id: 'animal-5',
            url: 'https://images.unsplash.com/photo-1518882605630-8a6c04fa7e55?w=600&h=400&fit=crop',
            name: 'Animal Feeding',
            tags: ['feeding', 'farm', 'animals']
        },
        {
            id: 'animal-6',
            url: 'https://images.unsplash.com/photo-1535930891776-0c2dfb7fda1a?w=600&h=400&fit=crop',
            name: 'Dog Walking',
            tags: ['dog', 'walking', 'exercise']
        }
    ],
    elderly: [
        {
            id: 'elder-1',
            url: 'https://images.unsplash.com/photo-1581579438747-1dc8d17bbce4?w=600&h=400&fit=crop',
            name: 'Senior Care',
            tags: ['senior', 'care', 'support']
        },
        {
            id: 'elder-2',
            url: 'https://images.unsplash.com/photo-1447452001602-7090c7ab2db3?w=600&h=400&fit=crop',
            name: 'Elderly Companionship',
            tags: ['companionship', 'elderly', 'visit']
        },
        {
            id: 'elder-3',
            url: 'https://images.unsplash.com/photo-1516733968668-dbdce39c0651?w=600&h=400&fit=crop',
            name: 'Reading Together',
            tags: ['reading', 'together', 'story']
        },
        {
            id: 'elder-4',
            url: 'https://images.unsplash.com/photo-1573497019940-1c28c88b4f3e?w=600&h=400&fit=crop',
            name: 'Home Visit',
            tags: ['home', 'visit', 'care']
        }
    ],
    youth: [
        {
            id: 'youth-1',
            url: 'https://images.unsplash.com/photo-1488521787991-ed7bbaae773c?w=600&h=400&fit=crop',
            name: 'Youth Program',
            tags: ['youth', 'children', 'program']
        },
        {
            id: 'youth-2',
            url: 'https://images.unsplash.com/photo-1472162072942-cd5147eb3902?w=600&h=400&fit=crop',
            name: 'Sports Activity',
            tags: ['sports', 'activity', 'kids']
        },
        {
            id: 'youth-3',
            url: 'https://images.unsplash.com/photo-1527529482837-4698179dc6ce?w=600&h=400&fit=crop',
            name: 'Art Workshop',
            tags: ['art', 'workshop', 'creative']
        },
        {
            id: 'youth-4',
            url: 'https://images.unsplash.com/photo-1560785477-d43d2b34e0df?w=600&h=400&fit=crop',
            name: 'Summer Camp',
            tags: ['summer', 'camp', 'outdoor']
        },
        {
            id: 'youth-5',
            url: 'https://images.unsplash.com/photo-1511632765486-a01980e01a18?w=600&h=400&fit=crop',
            name: 'Family Day',
            tags: ['family', 'day', 'fun']
        }
    ],
    'disaster-relief': [
        {
            id: 'disaster-1',
            url: 'https://images.unsplash.com/photo-1469571486292-0ba58a3f068b?w=600&h=400&fit=crop',
            name: 'Relief Supplies',
            tags: ['relief', 'supplies', 'help']
        },
        {
            id: 'disaster-2',
            url: 'https://images.unsplash.com/photo-1503676260728-1c00da094a0b?w=600&h=400&fit=crop',
            name: 'Emergency Response',
            tags: ['emergency', 'response', 'aid']
        },
        {
            id: 'disaster-3',
            url: 'https://images.unsplash.com/photo-1578357078586-491adf1aa5ba?w=600&h=400&fit=crop',
            name: 'Supply Distribution',
            tags: ['supply', 'distribution', 'disaster']
        }
    ],
    other: [
        {
            id: 'other-1',
            url: 'https://images.unsplash.com/photo-1559027615-cd4628902d4a?w=600&h=400&fit=crop',
            name: 'General Volunteer',
            tags: ['volunteer', 'general', 'help']
        },
        {
            id: 'other-2',
            url: 'https://images.unsplash.com/photo-1517457373958-b7bdd4587205?w=600&h=400&fit=crop',
            name: 'Event Setup',
            tags: ['event', 'setup', 'organization']
        },
        {
            id: 'other-3',
            url: 'https://images.unsplash.com/photo-1556761175-5973dc0f32e7?w=600&h=400&fit=crop',
            name: 'Office Help',
            tags: ['office', 'admin', 'help']
        }
    ]
};

// Get all images flattened
function getAllImages() {
    let allImages = [];
    Object.keys(EVENT_IMAGE_LIBRARY).forEach(category => {
        allImages = allImages.concat(EVENT_IMAGE_LIBRARY[category].map(img => ({
            ...img,
            category: category
        })));
    });
    return allImages;
}

// Get images by category
function getImagesByCategory(category) {
    return EVENT_IMAGE_LIBRARY[category.toLowerCase()] || EVENT_IMAGE_LIBRARY.other;
}

// Create image picker HTML
function createImagePicker(containerId, selectedImageUrl = '', causeFilter = 'all') {
    const container = document.getElementById(containerId);
    if (!container) return;
    
    const categories = Object.keys(EVENT_IMAGE_LIBRARY);
    
    container.innerHTML = `
        <label class="image-picker-label">Select Event Image</label>
        <div class="image-category-tabs">
            <button type="button" class="image-category-tab ${causeFilter === 'all' ? 'active' : ''}" data-category="all">All</button>
            ${categories.map(cat => `
                <button type="button" class="image-category-tab ${causeFilter === cat ? 'active' : ''}" data-category="${cat}">
                    ${cat.charAt(0).toUpperCase() + cat.slice(1).replace('-', ' ')}
                </button>
            `).join('')}
        </div>
        <div class="image-picker-grid" id="${containerId}-grid">
            ${renderImageGrid(causeFilter === 'all' ? getAllImages() : getImagesByCategory(causeFilter), selectedImageUrl)}
        </div>
        <input type="hidden" id="selectedImageUrl" name="imageUrl" value="${selectedImageUrl}">
        ${selectedImageUrl ? `
            <div class="selected-image-preview" id="${containerId}-preview">
                <img src="${selectedImageUrl}" alt="Selected">
                <div class="preview-info">
                    <p class="image-name">Selected Image</p>
                    <p>Click on another image to change</p>
                </div>
            </div>
        ` : ''}
    `;
    
    // Add event listeners
    container.querySelectorAll('.image-category-tab').forEach(tab => {
        tab.addEventListener('click', function(e) {
            e.preventDefault();
            container.querySelectorAll('.image-category-tab').forEach(t => t.classList.remove('active'));
            this.classList.add('active');
            const category = this.dataset.category;
            const images = category === 'all' ? getAllImages() : getImagesByCategory(category);
            document.getElementById(`${containerId}-grid`).innerHTML = renderImageGrid(images, document.getElementById('selectedImageUrl').value);
            attachImageClickListeners(containerId);
        });
    });
    
    attachImageClickListeners(containerId);
}

function renderImageGrid(images, selectedUrl) {
    return images.map(img => `
        <div class="image-picker-item ${img.url === selectedUrl ? 'selected' : ''}" data-url="${img.url}" data-name="${img.name}">
            <img src="${img.url}" alt="${img.name}" loading="lazy">
            <div class="image-overlay">${img.name}</div>
        </div>
    `).join('');
}

function attachImageClickListeners(containerId) {
    const container = document.getElementById(containerId);
    container.querySelectorAll('.image-picker-item').forEach(item => {
        item.addEventListener('click', function() {
            // Remove selection from all
            container.querySelectorAll('.image-picker-item').forEach(i => i.classList.remove('selected'));
            // Add selection to clicked
            this.classList.add('selected');
            
            const url = this.dataset.url;
            const name = this.dataset.name;
            
            // Update hidden input
            document.getElementById('selectedImageUrl').value = url;
            
            // Update/create preview
            let preview = document.getElementById(`${containerId}-preview`);
            if (!preview) {
                preview = document.createElement('div');
                preview.id = `${containerId}-preview`;
                preview.className = 'selected-image-preview';
                container.appendChild(preview);
            }
            preview.innerHTML = `
                <img src="${url}" alt="${name}">
                <div class="preview-info">
                    <p class="image-name">${name}</p>
                    <p>Click on another image to change</p>
                </div>
            `;
        });
    });
}

// Export for use
window.EVENT_IMAGE_LIBRARY = EVENT_IMAGE_LIBRARY;
window.createImagePicker = createImagePicker;
window.getImagesByCategory = getImagesByCategory;
window.getAllImages = getAllImages;

// ============================================
// IMAGE UPLOAD FUNCTIONALITY
// ============================================

// Create image upload section for events
function createImageUploadSection(containerId, onUpload) {
    const container = document.getElementById(containerId);
    if (!container) return;
    
    const uploadHTML = `
        <div class="image-upload-section" id="${containerId}-upload">
            <p style="font-size: 0.85rem; color: #64748b; margin-bottom: 0.75rem;">
                <strong>Or upload your own image</strong>
            </p>
            <div class="upload-area" onclick="document.getElementById('${containerId}-file').click()">
                <i data-lucide="upload-cloud"></i>
                <p>Click to upload or drag and drop</p>
                <span>PNG, JPG up to 5MB</span>
            </div>
            <input type="file" id="${containerId}-file" class="upload-input" accept="image/*">
            <div id="${containerId}-upload-preview" style="display: none;"></div>
        </div>
    `;
    
    container.insertAdjacentHTML('beforeend', uploadHTML);
    
    // Initialize icons
    if (typeof lucide !== 'undefined') lucide.createIcons();
    
    // File input handler
    const fileInput = document.getElementById(`${containerId}-file`);
    fileInput.addEventListener('change', function(e) {
        handleImageUpload(e.target.files[0], containerId, onUpload);
    });
    
    // Drag and drop
    const uploadSection = document.getElementById(`${containerId}-upload`);
    uploadSection.addEventListener('dragover', (e) => {
        e.preventDefault();
        uploadSection.classList.add('drag-over');
    });
    
    uploadSection.addEventListener('dragleave', () => {
        uploadSection.classList.remove('drag-over');
    });
    
    uploadSection.addEventListener('drop', (e) => {
        e.preventDefault();
        uploadSection.classList.remove('drag-over');
        const file = e.dataTransfer.files[0];
        if (file && file.type.startsWith('image/')) {
            handleImageUpload(file, containerId, onUpload);
        }
    });
}

function handleImageUpload(file, containerId, onUpload) {
    if (!file) return;
    
    // Validate file
    if (!file.type.startsWith('image/')) {
        alert('Please upload an image file');
        return;
    }
    
    if (file.size > 5 * 1024 * 1024) {
        alert('File size must be less than 5MB');
        return;
    }
    
    // Create preview
    const reader = new FileReader();
    reader.onload = function(e) {
        const preview = document.getElementById(`${containerId}-upload-preview`);
        const dataUrl = e.target.result;
        
        preview.style.display = 'block';
        preview.innerHTML = `
            <div class="upload-preview">
                <img src="${dataUrl}" alt="Uploaded image">
                <div class="upload-preview-info">
                    <div class="file-name">${file.name}</div>
                    <div class="file-size">${formatFileSize(file.size)}</div>
                </div>
                <button type="button" class="remove-btn" onclick="removeUploadedImage('${containerId}')">
                    <i data-lucide="x" style="width:16px;height:16px;"></i>
                </button>
            </div>
        `;
        
        if (typeof lucide !== 'undefined') lucide.createIcons();
        
        // Update hidden input with data URL (for demo - in production use actual upload)
        const urlInput = document.getElementById('selectedImageUrl');
        if (urlInput) urlInput.value = dataUrl;
        
        // Deselect library images
        document.querySelectorAll(`#${containerId} .image-picker-item`).forEach(item => {
            item.classList.remove('selected');
        });
        
        // Callback
        if (onUpload) onUpload(dataUrl, file);
    };
    reader.readAsDataURL(file);
}

function removeUploadedImage(containerId) {
    const preview = document.getElementById(`${containerId}-upload-preview`);
    if (preview) {
        preview.style.display = 'none';
        preview.innerHTML = '';
    }
    
    const fileInput = document.getElementById(`${containerId}-file`);
    if (fileInput) fileInput.value = '';
    
    const urlInput = document.getElementById('selectedImageUrl');
    if (urlInput) urlInput.value = '';
}

function formatFileSize(bytes) {
    if (bytes < 1024) return bytes + ' B';
    if (bytes < 1024 * 1024) return (bytes / 1024).toFixed(1) + ' KB';
    return (bytes / (1024 * 1024)).toFixed(1) + ' MB';
}

// ============================================
// AVATAR UPLOAD FUNCTIONALITY
// ============================================

const AVATAR_EMOJIS = ['ðŸ˜€', 'ðŸ˜Ž', 'ðŸ¤—', 'ðŸ¥³', 'ðŸ˜Š', 'ðŸ™‚', 'ðŸ˜‡', 'ðŸ¤©', 'ðŸ’ª', 'ðŸŒŸ'];
const AVATAR_COLORS = [
    '#10b981', '#3b82f6', '#8b5cf6', '#ec4899', '#f59e0b',
    '#ef4444', '#06b6d4', '#84cc16', '#f97316', '#6366f1'
];

function createAvatarUploader(buttonId, currentAvatar, onSave) {
    const button = document.getElementById(buttonId);
    if (!button) return;
    
    // Create modal HTML
    const modalHTML = `
        <div class="avatar-upload-modal" id="avatarModal">
            <div class="avatar-upload-dialog">
                <h3>Choose Your Avatar</h3>
                <p style="font-size: 0.85rem; color: #64748b; margin-bottom: 1rem;">Select an emoji or color for your profile</p>
                
                <div style="margin-bottom: 1rem;">
                    <p style="font-size: 0.75rem; color: #94a3b8; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.05em;">Emoji</p>
                    <div class="avatar-options" id="emojiOptions">
                        ${AVATAR_EMOJIS.map(emoji => `
                            <div class="avatar-option" data-emoji="${emoji}">${emoji}</div>
                        `).join('')}
                    </div>
                </div>
                
                <div>
                    <p style="font-size: 0.75rem; color: #94a3b8; margin-bottom: 0.5rem; text-transform: uppercase; letter-spacing: 0.05em;">Color</p>
                    <div class="avatar-options" id="colorOptions">
                        ${AVATAR_COLORS.map(color => `
                            <div class="avatar-option" data-color="${color}" style="background: ${color}; font-size: 0;"></div>
                        `).join('')}
                    </div>
                </div>
                
                <div class="avatar-upload-actions">
                    <button type="button" class="btn btn-outline" onclick="closeAvatarModal()">Cancel</button>
                    <button type="button" class="btn btn-primary" onclick="saveAvatar()">Save</button>
                </div>
            </div>
        </div>
    `;
    
    // Add modal to body if not exists
    if (!document.getElementById('avatarModal')) {
        document.body.insertAdjacentHTML('beforeend', modalHTML);
    }
    
    // State
    window.selectedAvatarEmoji = null;
    window.selectedAvatarColor = AVATAR_COLORS[0];
    window.onAvatarSave = onSave;
    
    // Button click handler
    button.addEventListener('click', () => {
        document.getElementById('avatarModal').classList.add('show');
    });
    
    // Emoji selection
    document.querySelectorAll('#emojiOptions .avatar-option').forEach(option => {
        option.addEventListener('click', function() {
            document.querySelectorAll('#emojiOptions .avatar-option').forEach(o => o.classList.remove('selected'));
            this.classList.add('selected');
            window.selectedAvatarEmoji = this.dataset.emoji;
        });
    });
    
    // Color selection
    document.querySelectorAll('#colorOptions .avatar-option').forEach(option => {
        option.addEventListener('click', function() {
            document.querySelectorAll('#colorOptions .avatar-option').forEach(o => o.classList.remove('selected'));
            this.classList.add('selected');
            window.selectedAvatarColor = this.dataset.color;
        });
    });
}

function closeAvatarModal() {
    document.getElementById('avatarModal').classList.remove('show');
}

function saveAvatar() {
    const avatarData = {
        emoji: window.selectedAvatarEmoji,
        color: window.selectedAvatarColor
    };
    
    // Save to localStorage
    localStorage.setItem('userAvatar', JSON.stringify(avatarData));
    
    // Call callback
    if (window.onAvatarSave) {
        window.onAvatarSave(avatarData);
    }
    
    closeAvatarModal();
}

function applyAvatarStyle(element, avatarData) {
    if (!element || !avatarData) return;
    
    if (avatarData.emoji) {
        element.textContent = avatarData.emoji;
        element.style.fontSize = '1.5rem';
    }
    
    if (avatarData.color) {
        element.style.background = avatarData.color;
    }
}

// Export upload functions
window.createImageUploadSection = createImageUploadSection;
window.handleImageUpload = handleImageUpload;
window.removeUploadedImage = removeUploadedImage;
window.createAvatarUploader = createAvatarUploader;
window.closeAvatarModal = closeAvatarModal;
window.saveAvatar = saveAvatar;
window.applyAvatarStyle = applyAvatarStyle;
